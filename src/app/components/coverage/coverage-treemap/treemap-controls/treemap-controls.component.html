<div class="treemap-controls" [class.expanded]="isExpanded">
    <div class="controls-header">
        <div class="title-row">
            <h3>Coverage Settings</h3>
            <div class="controls-actions">
                <button *ngIf="hasActiveFilters" class="clear-button" (click)="onClearFilters()">
                    Clear All
                </button>
                <button class="toggle-button" (click)="toggleExpanded()">
                    {{ isExpanded ? 'Hide Filters' : 'Show Filters' }}
                </button>
            </div>
        </div>
    </div>

    <div class="controls-content" [class.visible]="isExpanded">
        <!-- Quick Search -->
        <div class="control-group">
            <label for="searchTerm">Search Classes</label>
            <input type="text" id="searchTerm" [value]="searchTerm" (input)="onSearchTermChange($event)"
                placeholder="Search by class name...">
        </div>

        <!-- Package Filter -->
        <div class="control-group">
            <label for="packageFilter">Package</label>
            <select id="packageFilter" [value]="selectedPackage" (change)="onSelectedPackageChange($event)">
                <option value="">All Packages</option>
                <option *ngFor="let pkg of packageList" [value]="pkg">
                    {{ pkg }}
                </option>
            </select>
        </div>

        <!-- Min Coverage Filter -->
        <div class="control-group">
            <label for="minCoverage">
                Min Coverage: {{ minCoverage }}%
            </label>
            <input type="range" id="minCoverage" [value]="minCoverage" (input)="onMinCoverageChange($event)" min="0"
                max="100" step="5">
        </div>

        <!-- Min Lines Filter -->
        <div class="control-group">
            <label for="minLines">
                Min Lines: {{ minLines }}
            </label>
            <input type="range" id="minLines" [value]="minLines" (input)="onMinLinesChange($event)" min="0" max="100"
                step="5">
        </div>

        <!-- Sort Order -->
        <div class="control-group">
            <label for="sortBy">Sort By</label>
            <select id="sortBy" [value]="sortBy" (change)="onSortByChange($event)">
                <option *ngFor="let option of sortOptions" [value]="option.value">
                    {{ option.label }}
                </option>
            </select>
        </div>

        <div class="control-group toggles">
            <!-- Group Small Nodes Toggle -->
            <div class="toggle-control">
                <input type="checkbox" id="groupSmallNodes" [checked]="groupSmallNodes"
                    (change)="onToggleGrouping($event)">
                <label for="groupSmallNodes">Group Small Classes</label>
            </div>

            <!-- Show Labels Toggle -->
            <div class="toggle-control">
                <input type="checkbox" id="showLabels" [checked]="showLabels" (change)="onToggleLabels($event)">
                <label for="showLabels">Show Labels</label>
            </div>
        </div>

        <!-- Color Scheme -->
        <div class="control-group">
            <label for="colorMode">Color Scheme</label>
            <select id="colorMode" [value]="colorMode" (change)="onColorModeChange($event)">
                <option *ngFor="let option of colorModeOptions" [value]="option.value">
                    {{ option.label }}
                </option>
            </select>
        </div>
    </div>
</div>