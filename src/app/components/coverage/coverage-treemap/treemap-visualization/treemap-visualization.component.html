<div class="treemap-container" #container [class.dark-theme]="isDarkTheme"></div>

<!-- Tooltip that follows cursor -->
<div class="tooltip" [style.left.px]="tooltipX" [style.top.px]="tooltipY" [style.opacity]="showTooltip ? 1 : 0">
    <div *ngIf="tooltipNode" class="tooltip-content">
        <div class="tooltip-title">{{ tooltipNode.className || tooltipNode.packageName }}</div>
        <div class="tooltip-package" *ngIf="tooltipNode.packageName">
            {{ tooltipNode.packageName }}
        </div>
        <div class="tooltip-row">
            <span>Coverage:</span>
            <span [ngClass]="
                tooltipNode.coverage >= 90 ? 'excellent' : 
                tooltipNode.coverage >= 75 ? 'good' : 
                tooltipNode.coverage >= 50 ? 'moderate' : 'poor'">
                {{ tooltipNode.coverage.toFixed(1) }}%
            </span>
        </div>
        <div class="tooltip-row">
            <span>Lines:</span>
            <span>{{ tooltipNode.linesValid }}</span>
        </div>
        <div class="tooltip-row" *ngIf="tooltipNode.linesCovered !== undefined">
            <span>Covered:</span>
            <span>{{ tooltipNode.linesCovered }}</span>
        </div>
        <div class="tooltip-row" *ngIf="tooltipNode.branchRate !== undefined">
            <span>Branch Rate:</span>
            <span>{{ tooltipNode.branchRate.toFixed(1) }}%</span>
        </div>
    </div>
</div>