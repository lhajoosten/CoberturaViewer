import{a as U,b as B}from"./chunk-GTRWXQFM.js";import{a as $,b as G}from"./chunk-4YQF2CO5.js";import{a as V}from"./chunk-XC5NQH5T.js";import{f as N,l as R,m as j,p as H}from"./chunk-GQYAU5FR.js";import{$ as u,$a as e,$b as I,Ba as l,Bb as E,Cb as w,Db as F,Fa as d,Fb as k,Ka as S,Pa as p,Xa as c,Za as C,Zb as D,_ as v,a as P,ab as t,ac as z,bb as g,fb as h,hb as f,hc as T,ib as m,lc as L,rb as r,sb as _,tb as x}from"./chunk-SU5VR5TY.js";import{a as y,b as M}from"./chunk-EQDQRRRY.js";var K=(o,n)=>({"fa-file-code":o,"fa-file-alt":n}),X=(o,n,i)=>({high:o,medium:n,low:i});function A(o,n){if(o&1){let i=h();e(0,"div",24),g(1,"i",25),e(2,"p"),r(3,"No recent coverage files"),t(),e(4,"button",26),f("click",function(){v(i);let s=m();return u(s.navigateToUpload())}),r(5,"Upload Coverage Report"),t()()}}function Y(o,n){if(o&1&&(e(0,"div",37),r(1),t()),o&2){let i=m().$implicit;c("ngClass",w(2,X,i.summary.lineCoverage>=80,i.summary.lineCoverage>=60&&i.summary.lineCoverage<80,i.summary.lineCoverage<60)),l(),x(" ",i.summary.lineCoverage.toFixed(1),"% ")}}function J(o,n){if(o&1&&(e(0,"div",38),r(1),t()),o&2){let i=m().$implicit,a=m(2);l(),x(" ",a.formatFileSize(i.size)," ")}}function Q(o,n){if(o&1){let i=h();e(0,"li",29),f("click",function(){let s=v(i).$implicit,b=m(2);return u(b.loadFile(s))}),e(1,"div",30),g(2,"i",31),t(),e(3,"div",32)(4,"div",33),r(5),t(),e(6,"div",34),r(7),F(8,"date"),t()(),p(9,Y,2,6,"div",35)(10,J,2,1,"div",36),t()}if(o&2){let i=n.$implicit;l(2),c("ngClass",E(8,K,i.type==="xml"||i.type==="json",i.type==="sample")),l(3),_(i.name),l(2),_(k(8,5,i.date,"medium")),l(2),c("ngIf",(i.summary==null?null:i.summary.lineCoverage)!==void 0),l(),c("ngIf",!(i.summary!=null&&i.summary.lineCoverage)&&i.size)}}function W(o,n){if(o&1&&(e(0,"ul",27),p(1,Q,11,11,"li",28),t()),o&2){let i=m();l(),c("ngForOf",i.recentFiles)}}var q=class o{constructor(n,i,a,s,b,Z){this.coverageStore=n;this.router=i;this.fileHistoryService=a;this.toastService=s;this.coberturaParser=b;this.navigationGuard=Z;this.router.events.subscribe(O=>{O instanceof N&&console.log("Navigation started to:",O.url)})}hasData=!1;isLoading=!1;recentFiles=[];subscription=new P;lastClickTime=0;CLICK_DEBOUNCE_TIME=1e3;ngOnInit(){console.log("Dashboard initializing..."),this.subscription.add(this.coverageStore.getCoverageData().subscribe(n=>{this.hasData=!!n})),console.log("Subscribing to file history..."),this.subscription.add(this.fileHistoryService.getFiles().subscribe(n=>{console.log("Received recent files:",n),this.recentFiles=n}))}ngOnDestroy(){this.subscription.unsubscribe()}navigateToUpload(){this.router.navigate(["/upload"])}loadFile(n){if(console.log("Load file request:",n.name,n.id),this.isLoading||this.navigationGuard.isNavigatingTo("/visualization")||Date.now()-this.lastClickTime<this.CLICK_DEBOUNCE_TIME){console.log("Prevented duplicate file load");return}this.lastClickTime=Date.now(),this.isLoading=!0;try{let i=this.fileHistoryService.getFileContent(n.id);if(!i){this.toastService.showError("Error","Could not load file content"),this.isLoading=!1;return}console.log(`Retrieved content for ${n.name}, length: ${i.length}`);let a=this.coberturaParser.parseCoberturaXml(i);if(!a){this.toastService.showError("Error","Failed to parse coverage data"),this.isLoading=!1;return}this.coverageStore.setCoverageData(a);let s=M(y({},n),{date:new Date});this.fileHistoryService.addFile(s,i),this.toastService.showSuccess("Success",`Loaded coverage data from ${n.name}`),this.navigationGuard.startNavigation("/visualization"),setTimeout(()=>{this.router.navigate(["/visualization"],{replaceUrl:!0})},10)}catch(i){console.error("Error loading file:",i),this.toastService.showError("Error","Failed to load coverage data")}finally{this.isLoading=!1}}formatFileSize(n){return n<1024?`${n} B`:n<1024*1024?`${(n/1024).toFixed(1)} KB`:`${(n/(1024*1024)).toFixed(1)} MB`}loadRecentFiles(){console.log("Manually loading recent files..."),this.fileHistoryService.getFiles().subscribe(n=>{console.log("Received recent files:",n),this.recentFiles=n})}static \u0275fac=function(i){return new(i||o)(d(G),d(R),d(U),d(V),d($),d(B))};static \u0275cmp=S({type:o,selectors:[["app-dashboard"]],decls:84,vars:8,consts:[[1,"dashboard-container"],[1,"dashboard-header"],[1,"text-secondary"],[1,"dashboard-content"],[1,"quick-actions"],[1,"card","action-card",3,"click"],[1,"icon-container"],[1,"fas","fa-upload"],[1,"card","action-card",3,"routerLink"],[1,"fas","fa-chart-pie"],[1,"fas","fa-lightbulb"],[1,"recent-files"],[1,"section-header","recent-files-header"],["routerLink","/recent-files",1,"view-all"],[1,"card","file-list-card"],["class","empty-state",4,"ngIf"],["class","file-list",4,"ngIf"],[1,"getting-started"],[1,"section-header"],[1,"card"],[1,"steps"],[1,"step"],[1,"step-number"],[1,"step-content"],[1,"empty-state"],[1,"fas","fa-file-alt","empty-icon"],[1,"btn-primary",3,"click"],[1,"file-list"],["class","file-item",3,"click",4,"ngFor","ngForOf"],[1,"file-item",3,"click"],[1,"file-icon"],[1,"fas",3,"ngClass"],[1,"file-info"],[1,"file-name"],[1,"file-date"],["class","file-coverage",3,"ngClass",4,"ngIf"],["class","file-size",4,"ngIf"],[1,"file-coverage",3,"ngClass"],[1,"file-size"]],template:function(i,a){i&1&&(e(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Coverage Explorer Dashboard"),t(),e(4,"p",2),r(5,"Visualize and analyze your code coverage data"),t()(),e(6,"div",3)(7,"section",4)(8,"div",5),f("click",function(){return a.navigateToUpload()}),e(9,"div",6),g(10,"i",7),t(),e(11,"h3"),r(12,"Upload Coverage Report"),t(),e(13,"p"),r(14,"Import a Cobertura XML file to analyze coverage"),t()(),e(15,"div",8)(16,"div",6),g(17,"i",9),t(),e(18,"h3"),r(19,"Visualize Coverage"),t(),e(20,"p"),r(21,"Explore your coverage data through interactive charts"),t()(),e(22,"div",8)(23,"div",6),g(24,"i",10),t(),e(25,"h3"),r(26,"Coverage Insights"),t(),e(27,"p"),r(28,"Get actionable insights and improvement suggestions"),t()()(),e(29,"section",11)(30,"div",12)(31,"h2"),r(32,"Recent Files"),t(),e(33,"a",13),r(34,"View All"),t()(),e(35,"div",14),p(36,A,6,0,"div",15)(37,W,2,1,"ul",16),t()(),e(38,"section",17)(39,"div",18)(40,"h2"),r(41,"Getting Started"),t()(),e(42,"div",19)(43,"div",20)(44,"div",21)(45,"div",22),r(46,"1"),t(),e(47,"div",23)(48,"h4"),r(49,"Upload Coverage Report"),t(),e(50,"p"),r(51,"Import a Cobertura XML coverage report file generated by your test framework."),t()()(),e(52,"div",21)(53,"div",22),r(54,"2"),t(),e(55,"div",23)(56,"h4"),r(57,"Visualize Code Coverage"),t(),e(58,"p"),r(59,"Explore your code coverage through interactive sunburst and treemap visualizations."),t()()(),e(60,"div",21)(61,"div",22),r(62,"3"),t(),e(63,"div",23)(64,"h4"),r(65,"Get Insights & Take Action"),t(),e(66,"p"),r(67,"Receive actionable insights about coverage gaps and improve your test coverage."),t()()(),e(68,"div",21)(69,"div",22),r(70,"4"),t(),e(71,"div",23)(72,"h4"),r(73,"Compare reports"),t(),e(74,"p"),r(75,"Compare last time reports to the most recent to see differences in coverage"),t()()(),e(76,"div",21)(77,"div",22),r(78,"5"),t(),e(79,"div",23)(80,"h4"),r(81,"Export & Share"),t(),e(82,"p"),r(83,"Share your coverage reports with your team and explore them together."),t()()()()()()()()),i&2&&(l(15),C("disabled",!a.hasData),c("routerLink",a.hasData?"/visualization":null),l(7),C("disabled",!a.hasData),c("routerLink",a.hasData?"/insights":null),l(14),c("ngIf",!a.recentFiles||a.recentFiles.length===0),l(),c("ngIf",a.recentFiles&&a.recentFiles.length>0))},dependencies:[L,D,I,z,T,H,j],styles:['.dashboard-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;padding:1rem 0}.dashboard-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--color-text-default)}.dashboard-content[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-gap:2rem}@media (min-width: 1024px){.dashboard-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:"actions actions" "files getting-started"}}.quick-actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;grid-area:actions}.action-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;padding:2rem 1.5rem;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease}.action-card[_ngcontent-%COMP%]:hover:not(.disabled){transform:translateY(-5px);box-shadow:var(--color-card-shadow)}.action-card.disabled[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}.action-card[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:var(--color-primary);color:#fff;display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.action-card[_ngcontent-%COMP%]   .icon-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.75rem}.action-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:1.25rem}.action-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);margin-bottom:0}.getting-started[_ngcontent-%COMP%]{grid-area:getting-started}.steps[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.step[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:flex-start;padding:.25em}.step[_ngcontent-%COMP%]   .step-number[_ngcontent-%COMP%]{width:30px;height:30px;border-radius:50%;background-color:var(--color-primary);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;flex-shrink:0}.step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1rem}.step[_ngcontent-%COMP%]   .step-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--color-text-secondary);font-size:.875rem}.btn-primary[_ngcontent-%COMP%]{background-color:var(--color-primary);color:#fff;border:none;padding:.5rem 1rem;border-radius:4px;font-weight:500;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]:hover{background-color:var(--color-btn-primary-hover)}.section-header[_ngcontent-%COMP%]{margin:3em 0 5px}.recent-files-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:3em 0 0}.file-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:.25em}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 16px;border-bottom:1px solid var(--color-border-light);cursor:pointer;transition:background-color .2s ease}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]:hover{background-color:var(--color-bg-hover)}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]{margin-right:12px;font-size:1.25rem;color:var(--color-primary)}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{flex:1}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-weight:500;margin-bottom:4px}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-date[_ngcontent-%COMP%]{font-size:.8125rem;color:var(--color-text-secondary)}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-coverage[_ngcontent-%COMP%]{font-weight:600;font-size:.9375rem;padding:4px 8px;border-radius:4px}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-coverage.high[_ngcontent-%COMP%]{background-color:var(--color-success-light);color:var(--color-success-dark)}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-coverage.medium[_ngcontent-%COMP%]{background-color:var(--color-warning-light);color:var(--color-warning-dark)}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-coverage.low[_ngcontent-%COMP%]{background-color:var(--color-danger-light);color:var(--color-danger-dark)}.file-list[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-size[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text-secondary)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:3rem;color:var(--color-text-secondary);opacity:.5;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:var(--color-text-secondary);margin-bottom:1.5rem}.view-all[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-primary);text-decoration:none}.view-all[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};export{q as DashboardComponent};
